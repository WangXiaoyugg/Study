//爬虫为实现分页爬信息的功能var https = require('https');var fs = require('fs');var path = require('path');var cheerio = require('cheerio');var opt = {    hostname:'movie.douban.com',    path:'/top250',    port:443};https.get(opt,function (res) {    var html = '';    var movies = [];    res.setEncoding('utf-8');    res.on('data',function (chunk) {        html += chunk;    });    res.on('end',function () {        var $ = cheerio.load(html);        $('.item').each(function () {            var movie = {                title:$('.title',this).text(),                star:$('.star .rating_num',this).text(),                link:$('a',this).attr('href'),                picUrl:$('.pic img',this).attr('src')            };            movies.push(movie);            downloadImg('img/',movie.picUrl);        });        console.log(movies);        saveData('data/data.json',movies);    });}).on('error',function (err) {   console.log(err);});//保存数据到本地function saveData(path,movies) {    fs.writeFile(path,JSON.stringify(movies,null,4),function (err) {        if(err) return console.log(err);        console.log('Data saved');    })}//下载图片function  downloadImg(imgDir,url) {    https.get(url,function (res) {       var data = '';       res.setEncoding('binary');       res.on('data',function (chunk) {           data += chunk;       });       res.on('end',function () {           fs.writeFile(imgDir + path.basename(url),data,'binary',function (err) {               if(err) return console.log(err);               console.log('Image downloaded: ',path.basename(url));           });       });    }).on('error',function (err) {       if(err) console.log(err);    });}