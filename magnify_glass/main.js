//获取元素var canvas = document.getElementById('canvas');var context = canvas.getContext('2d');var copycanvas = document.getElementById('copycanvas');var copycontext = copycanvas.getContext('2d');var square = document.getElementById('square');//选择框对象，用来保存所需的选择框数据var squareData = {};//getBoundingClientRect方法可以获取元素上、下、左、右分别相对浏览器的坐标位置var box = canvas.getBoundingClientRect();//创建图像对象，并加载var img = new Image();img.src = 'fdj.jpeg';img.onload = function () {    //绘制canvas图像    context.drawImage(img,0,0,canvas.width,canvas.height);};//触发事件canvas.onmouseover = function (e) {    //鼠标的坐标   var x = e.clientX;   var y = e.clientY;   //保存透明选择框的属性    createSquare(x,y);};window.onmousemove = function (e) {    //鼠标的坐标    var x = e.clientX;    var y = e.clientY;    // console.log('offsetLeft',canvas.offsetLeft);//8    // console.log('offsetTop',canvas.offsetTop); //8    //判断鼠标是否移出canvas;    if(x >= canvas.offsetLeft && x <= canvas.offsetLeft + canvas.width        && y >= canvas.offsetTop && y<= canvas.offsetTop + canvas.height){        createSquare(x,y);    }else{        //移出canvas 就不显示 移动选择框和 放大镜的copycanvas;        hideSquare();        hideCanvas();    }};//显示，隐藏选择框和copycanvas;function showSquare(){    square.style.display = 'block';}function hideSquare() {    square.style.display = 'none';}function showCanvas() {    copycanvas.style.display = 'inline';}function hideCanvas() {    copycanvas.style.display = 'none';}//移动鼠标同时实时移动选择框function createSquare(x,y) {    x = x-45 < canvas.offsetLeft ? canvas.offsetLeft : x-45;    y = y-45 < canvas.offsetTop ? canvas.offsetTop : y-45;    x = x+90 < box.right ? x:box.right - 90;    y = y+90 <box.bottom ? y:box.bottom -90;    squareData.left = x;    squareData.top = y;    moveSquare(x,y);}function moveSquare(x,y) {    square.style.left = x + 'px';    square.style.top = y + 'px';    showCanvas();    showSquare();    copy();}function copy() {    copycontext.drawImage(        canvas,        squareData.left - box.left,        squareData.top - box.top,        90,        90,        0,0,copycanvas.width,copycanvas.height    )}